# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## Project Overview

This is a modern chat application built with React, TypeScript, and Vite, featuring real-time AI conversation capabilities through Supabase Edge Functions and the Lovable AI gateway. The application mimics the Grok chat interface with a dark theme and includes advanced features like chat history, attachments, markdown rendering, and code syntax highlighting.

## Essential Commands

### Development
```bash
npm run dev            # Start development server (runs on port 8080)
npm run build         # Build for production
npm run build:dev     # Build in development mode with source maps
npm run preview       # Preview production build locally
npm run lint          # Run ESLint
```

### Package Management
This project uses npm for package management. Both `npm install` and `bun install` are supported, but npm is the primary package manager.

### Supabase Functions
```bash
supabase functions serve  # Run Supabase functions locally
supabase functions deploy chat  # Deploy the chat edge function
```

## Architecture Overview

### Frontend Structure
- **React 18** with TypeScript and Vite for fast development
- **shadcn/ui** component library with Radix UI primitives
- **Tailwind CSS** for styling with a custom dark theme
- **Framer Motion** for animations and micro-interactions
- **React Query (TanStack Query)** for server state management
- **React Router** for client-side routing

### Key Components Architecture
- `Index.tsx` - Main chat interface page
- `ChatMessage.tsx` - Displays user/AI messages with markdown rendering
- `ChatInput.tsx` - Advanced input component with attachments, emoji picker, and AI modes
- `Sidebar.tsx` - Chat history management with drag-and-drop reordering, search, and categories
- `useChat.ts` - Core chat hook managing message state and streaming responses

### Backend Integration
- **Supabase** for backend services and edge functions
- **Chat Edge Function** (`supabase/functions/chat/index.ts`) - Handles AI completions via Lovable AI gateway
- **Streaming Responses** - Real-time message streaming from the AI model
- **CORS Configuration** - Properly configured for cross-origin requests

### Styling System
- Uses CSS variables for theming (`hsl(var(--primary))` pattern)
- Dark mode by default with custom color palette
- Responsive design with mobile-first approach
- Custom scrollbars and animations

## Important Implementation Details

### Chat Functionality
- Messages are streamed from the AI using Server-Sent Events (SSE)
- Chat history is stored in localStorage with categorization and search
- Supports two AI modes: "Fun Mode" and "Regular Mode"
- File attachments and image uploads are supported but require backend handling

### State Management
- Chat messages managed by `useChat` hook with optimistic updates
- Sidebar state managed locally with persistence to localStorage
- Toast notifications for error handling

### Environment Variables Required
```
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_PUBLISHABLE_KEY=your_supabase_anon_key
LOVABLE_API_KEY=your_lovable_api_key  # Server-side only
```

### Code Patterns
- Components use `memo()` for performance optimization
- Consistent use of TypeScript interfaces for props
- Custom hooks for reusable logic
- Utility-first CSS with Tailwind
- Path aliases configured: `@/` maps to `src/`

## Development Workflow

### Adding New Features
1. Components go in `src/components/` 
2. UI primitives go in `src/components/ui/` (generated by shadcn)
3. Custom hooks go in `src/hooks/`
4. Utilities go in `src/lib/`
5. Pages go in `src/pages/`

### Styling Guidelines
- Use the `cn()` utility from `src/lib/utils.ts` for conditional classes
- Follow the existing color system with CSS variables
- Use Tailwind's responsive prefixes consistently
- Animations should use Framer Motion for complex interactions

### AI Integration
The chat function streams responses from the Lovable AI gateway using the Gemini 2.5 Flash model. The system message defines "AJ STUDIOZ" as an advanced AI assistant. Error handling includes rate limiting (429) and credit depletion (402) responses.

### Database Schema
Currently using a minimal Supabase setup with no defined tables - the types file shows empty schemas, indicating this is primarily a frontend application with edge functions for AI integration.

## Deployment Notes
- This is a Lovable.dev project that can be deployed through their platform
- The Supabase project ID is `lcqepfwabbkfqcxpvsnk`
- JWT verification is disabled for the chat function
- The application runs on port 8080 in development with hot module replacement enabled